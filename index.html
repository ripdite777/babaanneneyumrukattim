<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Babaannene Tır Çarpmadan Kaç</title>
    <style>
        body {
            text-align: center;
            background-color: #f0f0f0;
            overflow: hidden;
            touch-action: none;
        }
        #oyunAlani {
            width: 100%;
            height: 500px;
            background: linear-gradient(to bottom, #888, #555);
            position: relative;
            overflow: hidden;
            border: 5px solid black;
        }
        #babaanne {
            width: 80px;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            transition: transform 0.1s ease-in-out;
        }
        .tir {
            width: 100px;
            position: absolute;
            top: -120px;
        }
        .diken {
            width: 30px;
            height: 30px;
            position: absolute;
            top: -50px;
        }
        #puan {
            font-size: 24px;
            font-weight: bold;
            margin-top: 10px;
        }
        #tokat {
            position: absolute;
            width: 60px;
            display: none;
        }
        #babaanneFirlama {
            position: fixed;
            width: 200px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            transition: transform 0.5s ease-out;
            display: none;
        }
        #seviyeSecim {
            margin-top: 50px;
        }
        #seviyeSecim button {
            font-size: 20px;
            padding: 10px 20px;
            margin: 10px;
        }
    </style>
</head>
<body>

    <h1>Babaannene Tır Çarpmadan Kaç</h1>
    <p id="puan">Puan: 0</p>

    <div id="seviyeSecim">
        <h2>Zorluk Seçin</h2>
        <button onclick="setSeviye('kolay')">Kolay</button>
        <button onclick="setSeviye('normal')">Normal</button>
        <button onclick="setSeviye('zor')">Zor</button>
    </div>

    <div id="oyunAlani">
        <img id="babaanne" src="images__7_-removebg-preview.png" alt="Babaanne">
        <img id="tokat" src="tokat.png" alt="Tokat">
    </div>
    <img id="babaanneFirlama" src="babaanne.png" alt="Fırlayan Babaanne">

    <audio id="carpmaSesi" src="carpma.mp3"></audio>
    <audio id="tokatSesi" src="tokat.mp3"></audio>

    <script>
        let oyunAlani = document.getElementById("oyunAlani");
        let babaanne = document.getElementById("babaanne");
        let tokat = document.getElementById("tokat");
        let puanGosterge = document.getElementById("puan");
        let babaanneFirlama = document.getElementById("babaanneFirlama");
        let carpmaSesi = document.getElementById("carpmaSesi");
        let tokatSesi = document.getElementById("tokatSesi");

        let puan = 0;
        let tirHizi = 5;
        let seviyeler = {kolay: 3, normal: 5, zor: 8}; // Hız seviyeleri
        let seviye = '';
        let hitboxKucuk = true;
        let hareketEdiyor = false;
        let durmaSuresi = 0;
        let dokunmaBaslangicX = 0;
        let babaanneX = 0;
        let dikenler = [];

        // Zorluk seviyesini ayarlama
        function setSeviye(yeniSeviye) {
            seviye = yeniSeviye;
            tirHizi = seviyeler[seviye];
            puan = 0;
            puanGosterge.innerText = "Puan: " + puan;
            clearDikenler();
            document.getElementById('seviyeSecim').style.display = 'none';
            oyunBaslat();
        }

        // Oyunu başlat
        function oyunBaslat() {
            setInterval(tirOlustur, 1500);
            setInterval(ekleDiken, 2000); // Zor seviyesinde dikenler
        }

        // Dikenleri ekleme fonksiyonu
        function ekleDiken() {
            if (seviye === 'zor') {
                let diken = document.createElement("img");
                diken.src = "diken.png"; // Bu dosyayı eklemelisiniz
                diken.classList.add("diken");
                diken.style.left = Math.random() * (oyunAlani.clientWidth - 30) + "px";
                oyunAlani.appendChild(diken);
                dikenler.push(diken);

                let dikenInterval = setInterval(() => {
                    diken.style.top = (diken.offsetTop + tirHizi) + "px";

                    if (carpistiMi(babaanne, diken)) {
                        carpmaSesi.play();
                        babaanneFirlama.style.display = "block";
                        babaanneFirlama.style.transform = "translate(-50%, -50%) scale(1.5)";
                        setTimeout(() => {
                            alert("Babaannene dikenlere çarptı! Oyun bitti. Puanın: " + puan);
                            location.reload();
                        }, 800);
                    }

                    if (diken.offsetTop > oyunAlani.clientHeight) {
                        diken.remove();
                        clearInterval(dikenInterval);
                    }
                }, 30);
            }
        }

        // Dikenleri temizle
        function clearDikenler() {
            dikenler.forEach(diken => {
                diken.remove();
            });
            dikenler = [];
        }

        // Mobil dokunmatik kontrol
        oyunAlani.addEventListener("touchstart", (e) => {
            let dokunma = e.touches[0];
            dokunmaBaslangicX = dokunma.clientX - babaanne.offsetLeft;
            hareketEdiyor = true;
        });

        oyunAlani.addEventListener("touchmove", (e) => {
            let dokunma = e.touches[0];
            let yeniX = dokunma.clientX - dokunmaBaslangicX;
            yeniX = Math.max(0, Math.min(oyunAlani.clientWidth - babaanne.clientWidth, yeniX));
            babaanne.style.left = yeniX + "px";
            hareketEdiyor = true;
        });

        oyunAlani.addEventListener("touchend", () => {
            hareketEdiyor = false;
            durmaSuresi = 0;
        });

        function tirOlustur() {
            let tir = document.createElement("img");
            tir.src = "tir.png";
            tir.classList.add("tir");
            tir.style.left = Math.random() * (oyunAlani.clientWidth - 100) + "px";
            oyunAlani.appendChild(tir);
            
            let tirInterval = setInterval(() => {
                tir.style.top = (tir.offsetTop + tirHizi) + "px";

                // Çarpışma kontrolü - Hitbox'ları küçük tutuyoruz
                if (carpistiMi(babaanne, tir)) {
                    carpmaSesi.play();
                    babaanneFirlama.style.display = "block";
                    babaanneFirlama.style.transform = "translate(-50%, -50%) scale(1.5)";
                    setTimeout(() => {
                        alert("Babaannene tır çarptı! Oyun bitti. Puanın: " + puan);
                        location.reload();
                    }, 800);
                }

                if (tir.offsetTop > oyunAlani.clientHeight) {
                    tir.remove();
                    clearInterval(tirInterval);
                    puan += 10;
                    puanGosterge.innerText = "Puan: " + puan;
                    
                    if (puan % 50 === 0) {
                        tirHizi += 1;
                    }
                }
            }, 30);
        }

        function carpistiMi(a, b) {
            // Hitbox hesaplama - Küçük hitbox tutma
            let aRect = a.getBoundingClientRect();
            let bRect = b.getBoundingClientRect();

            // Küçük hitbox (her seviyede aynı)
            aRect.width = aRect.width * 0.25; // Hitbox'ı biraz küçültüyoruz
            aRect.height = aRect.height * 0.25;

            return !(aRect.top > bRect.bottom || aRect.bottom < bRect.top || aRect.right < bRect.left || aRect.left > bRect.right);
        }

        function tokatAt() {
            if (!hareketEdiyor) {
                durmaSuresi++;
                if (durmaSuresi > 100) {
                    tokatSesi.play();
                    tokat.style.left = babaanne.offsetLeft + "px";
                    tokat.style.top = (babaanne.offsetTop - 50) + "px";
                    tokat.style.display = "block";

                    setTimeout(() => {
                        tokat.style.display = "none";
                        babaanne.style.left = (babaanne.offsetLeft + (Math.random() < 0.5 ? -50 : 50)) + "px";
                        durmaSuresi = 0;
                    }, 500);
                }
            }
        }

        setInterval(tokatAt, 100);
    </script>
</body>
</html>
